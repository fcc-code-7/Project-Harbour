@using FYP.Entities
﻿@using Microsoft.AspNetCore.Identity
@inject UserManager<AppUser> UserManager
@{
    var userId = UserManager.GetUserId(User);
    var userName = UserManager.GetUserName(User);

}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>@ViewData["Title"] - FYP.Web</title>
    <link rel="apple-touch-icon" href="~/app-assets/images/ico/apple-icon-120.png">
    <link rel="shortcut icon" type="image/x-icon" href="~/app-assets/images/ico/favicon.ico">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i%7COpen+Sans:300,300i,400,400i,600,600i,700,700i" rel="stylesheet">
    @await RenderSectionAsync("Styles", required: false)
    <!-- BEGIN: Vendor CSS-->
    <link href="https://cdn.richtexteditor.com/latest/rte_theme_default.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/css/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/css/animate/animate.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/css/extensions/sweetalert2.min.css">
    <!-- END: Vendor CSS-->
    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/css/vendors.min.css">
    <!-- END: Vendor CSS-->
    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/colors.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/components.css">
    <link href="~/app-assets/css/bootstrap.min.css" rel="stylesheet" />

    <!-- END: Theme CSS-->
    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/style.css">
    <!-- END: Custom CSS-->
    <link href="~/css/site.css" rel="stylesheet" />
    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/core/colors/palette-gradient.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/fonts/simple-line-icons/style.min.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/pages/card-statistics.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/pages/vertical-timeline.css">
    <!-- END: Page CSS-->
    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/core/colors/palette-gradient.css">
    <!-- Add Tailwind CSS via CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
          integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
          crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* For Chrome, Safari, Edge, and Opera */
        ::-webkit-scrollbar {
            width: 6px; /* Set the width of the scrollbar */
            height: 6px; /* Set the height of the scrollbar (for horizontal scrollbars) */
        }

        ::-webkit-scrollbar-track {
            background: transparent; /* Background of the scrollbar track */
        }

        ::-webkit-scrollbar-thumb {
            background-color: rgba(0, 0, 0, 0.2); /* Scrollbar color with transparency */
            border-radius: 10px; /* Rounded corners for the scrollbar */
        }

            ::-webkit-scrollbar-thumb:hover {
                background-color: rgba(0, 0, 0, 0.5); /* Darker on hover */
            }

        .mainDivGradient {
            /* background: linear-gradient(90deg, #f6d5f7, #fbe9d7) !important; */
            background: #ffffff !important;
        }

        .cardList {
            background: #ffffff !important;
            font-family: Arial, sans-serif !important;
        }

        .colorChange {
            color: #dc2626 !important;
        }

        .AssignButton {
            background: #f59e0b !important;
        }

        .NewBTN {
            background: #22d3ee !important;
        }

        .DownloadButton {
            background: #047857 !important;
        }

        .AddButton {
            background: #06b6d4 !important;
        }


        .loading-spinner-overlay {
            display: none; /* Initially hidden */
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            z-index: 9999; /* Ensure it appears above all other content */
            background-color: rgba(0,0,0,0.5); /* Transparent black */
        }


        .spinner {
            border: 16px solid #f3f3f3;
            border-top: 16px solid #3498db;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: spin 2s linear infinite;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }


        @@keyframes spin {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }
    </style>
</head>
<body class="vertical-layout vertical-menu 2-columns  cardList fixed-navbar " id="body" data-open="click" data-menu="vertical-menu" data-col="2-columns">

    <header>
        <!-- BEGIN: Header-->
        <nav class="header-navbar navbar-expand-md navbar navbar-with-menu fixed-top navbar-dark navbar-shadow">
            <div class="navbar-wrapper">
                <div class="navbar-header">
                    <ul class="nav navbar-nav flex-row">
                        <li class="nav-item mobile-menu d-md-none mr-auto"><a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#"><i class="feather icon-menu font-large-1"></i></a></li>
                        <li class="nav-item">
                            <a class="navbar-brand d-flex align-items-center" href="">
                                <img class="brand-logo me-2" alt="stack admin logo" src="~/app-assets/images/logo/stack-logo.png">
                                <span class="brand-text">FYP</span>
                            </a>

                        </li>
                        <li class="nav-item d-md-none"><a class="nav-link open-navbar-container" data-toggle="collapse" data-target="#navbar-mobile"><i class="fa fa-ellipsis-v"></i></a></li>
                    </ul>
                </div>
                <div class="navbar-container content">
                    <div class="collapse navbar-collapse" id="navbar-mobile">
                        <ul class="nav navbar-nav mr-auto float-left">
                            <li class="nav-item d-none d-md-block"><a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#"><i class="feather icon-menu"></i></a></li>

                        </ul>
                        <ul class="nav navbar-nav float-right">

                          
                            <li class="dropdown dropdown-notification nav-item">
                                <a class="nav-link nav-link-label" id="messages" data-toggle="dropdown"><i class="ficon feather icon-mail"></i></a>
                                
                            </li>
                            <li class="dropdown dropdown-user nav-item">
                                <a class="dropdown-toggle nav-link dropdown-user-link" href="#" data-toggle="dropdown">
                                    <div class="avatar avatar-online"><img src="~/app-assets/images/portrait/small/avatar-s-1.png" alt="avatar"><i></i></div><span class="user-name">@userName</span>

                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="user-profile.html"><i class="feather icon-user"></i> Edit Profile</a><a class="dropdown-item" href="app-chat.html"><i class="feather icon-message-square"></i> Chats</a>
                                    <div class="dropdown-divider"></div><a class="dropdown-item" href="@Url.Action("Logout", "Account")"<i class="feather icon-power"></i> Logout</a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
        <!-- END: Header-->
    </header>
    <div id="loadingSpinner" class="loading-spinner-overlay">
        <div class="spinner"></div>
    </div>
    <main class="">
        <!-- BEGIN: Main Menu-->
        <div class=" main-menu menu-fixed menu-dark menu-accordion menu-shadow " data-scroll-to-active="true">
            <div class=" main-menu-content ">
                @{
                    if (User.Identity.IsAuthenticated)
                    {
                        <ul class=" navigation navigation-main " id="main-menu-navigation " data-menu="menu-navigation">
                            <li class=" navigation-header">
                                <span>General</span>
                                <i class="feather icon-minus" data-toggle="tooltip" data-placement="right" data-original-title="General"></i>
                            </li>
                            <li class=" nav-item" id="profile">
                                <a>
                                    <i class="fa fa-user-circle-o"></i>
                                    <span class="menu-item" data-i18n="Profile">Profile</span>
                                </a>
                            </li>

                            @if (User.IsInRole("Supervisor"))
                            {
                                <li class="nav-item" id="ProjectsSup">
                                    <a>
                                        <i class="fa fa-calendar-check-o"></i>
                                        <span class="menu-item" data-i18n="Projects">Projects</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="groups">
                                    <a>
                                        <i class="fa fa-users"> </i>
                                        <span class="menu-item" data-i18n="Groups">Groups</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="evaluationExam">
                                    <a>
                                        <i class="fa fa-users"></i>
                                        <span class="menu-item" data-i18n="Evaluation">Evaluation</span>
                                    </a>
                                </li>
                            }
                            else if (User.IsInRole("Student"))
                            {
                                <li class="nav-item" id="Projects">
                                    <a>
                                        <i class="fa fa-calendar-check-o"></i>
                                        <span class="menu-item" data-i18n="Projects">Projects</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="Submissions">
                                    <a>
                                        <i class="fa fa-cloud-upload"></i>
                                        <span class="menu-item" data-i18n="Submissions">Submissions</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="WeeklyLogs">
                                    <a>
                                        <i class="fa fa-cloud-upload"></i>
                                        <span class="menu-item" data-i18n="WeeklyLogs">Weekly Logs</span>
                                    </a>
                                </li>
                            }
                            else if (User.IsInRole("Cordinator"))
                            {
                                <li class="nav-item" id="groups">
                                    <a>
                                        <i class="fa fa-users"></i>
                                        <span class="menu-item" data-i18n="Groups">Groups</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="ProjectsSup">
                                    <a>
                                        <i class="feather icon-edit"></i>
                                        <span class="menu-item" data-i18n="Projects">Projects</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="EvaluationDates">
                                    <a>
                                        <i class="feather icon-edit"></i>
                                        <span class="menu-item" data-i18n="EvaluationDates">EvalDate</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="Evaluators">
                                    <a>
                                        <i class="feather icon-calendar"></i>
                                        <span class="menu-item" data-i18n="Evaluators">Evaluators</span>
                                    </a>
                                </li>
                                <li class="nav-item" id="Externals">
                                    <a>
                                        <i class="feather icon-calendar"></i>
                                        <span class="menu-item" data-i18n="Externals">Externals</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a>
                                        <i class="feather icon-settings"></i>
                                        <span class="menu-item" data-i18n="Settings">Settings</span>
                                    </a>
                                    <ul class="menu-content">
                                        <li>
                                            <a class="menu-item" id="Rooms" data-i18n="Rooms">Rooms</a>
                                        </li>
                                        <li>
                                            <a class="menu-item" id="RoomIncharges" data-i18n="Room Incharge">Room Incharge</a>
                                        </li>
                                    </ul>
                                </li>

                            }
                            else if (User.IsInRole("External"))
                            {
                                <li class="nav-item" id="GroupsEvaluation">
                                    <a>
                                        <i class="feather icon-mail"></i>
                                        <span class="menu-item" data-i18n="GroupsEvaluation">Groups</span>
                                    </a>
                                </li>
                            }
                            <li class="nav-item" id="Message">
                                <a>
                                    <i class="feather icon-mail"></i>
                                    <span class="menu-item" data-i18n="Messages">Messages</span>
                                </a>
                            </li>
                        </ul>
                    }
                }


            </div>
        </div>
        <!-- END: Main Menu-->
    </main>



    @RenderBody()

    <div class="sidenav-overlay"></div>
    <div class="drag-target"></div>


    <!-- BEGIN: Vendor JS-->
    <script src="~/app-assets/vendors/js/vendors.min.js"></script>
    <!-- BEGIN Vendor JS-->
    <!-- BEGIN: Theme JS-->
    <script src="~/app-assets/js/core/app-menu.js"></script>
    <script src="~/app-assets/js/core/app.js"></script>
    <!-- END: Theme JS-->
    <script src="~/app-assets/js/scripts/modal/components-modal.js"></script>
    <script src="~/app-assets/js/scripts/ui/scrollable.js"></script>
    <!-- BEGIN: Page JS-->
    <!-- END: Page JS-->
    <!-- BEGIN: Page Vendor JS-->
    <script src="~/app-assets/js/core/libraries/bootstrap.min.js"></script>
    <script src="~/app-assets/vendors/js/extensions/polyfill.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.richtexteditor.com/latest/rte.js"></script>

    <!-- END: Page Vendor JS-->
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>

<script>
    function showLoadingSpinner() {
        document.getElementById('loadingSpinner').style.display = 'block';
    }

    function hideLoadingSpinner() {
        document.getElementById('loadingSpinner').style.display = 'none';
    }
    $(document).ready(function () {
        var currentUrl = window.location.pathname;
        $('.nav-item > a').each(function () {
            var linkUrl = $(this).attr('href');
            if (currentUrl === linkUrl) {
                $(this).parent().addClass('active');
            }
        });

        function loadAdminIndex(successCallback) {
            showLoadingSpinner(); // Show the loading spinner
            $.ajax({
                url: "/supervisor/index",
                type: "GET",
                success: function (data) {

                    successCallback();
                    hideLoadingSpinner(); // Hide the loading spinner

                },
                error: function (err) {
                    alert("An error occurred while loading the Admin Index: " + err.statusText);
                }
            });
        }

        function loadSection(url, container) {
            $.ajax({
                url: url,
                type: "GET",
                success: function (data) {
                    $(container).html(data);
                    // console.log(data);
                    localStorage.setItem('lastSection', url);
                },
                error: function (err) {
                    alert("An error occurred while loading the section: " + err.statusText);
                }
            });
        }

        function loadLastSection() {
            var lastSection = localStorage.getItem('lastSection');
            if (lastSection) {
                loadSection(lastSection, "#MainContainer");
            }
        }

        $("#groups").click(function () {
            loadAdminIndex(function () {
                loadSection("/studentgroups/StudentGroups", "#MainContainer");
            });
        });
        $("#ProjectsSup").click(function () {
            loadAdminIndex(function () {
                loadSection("/supervisor/projects", "#MainContainer");
            });
        });
        $("#profile").click(function () {
            loadAdminIndex(function () {
                loadSection("/user/profile", "#MainContainer");
            });
        });
        $("#Projects").click(function () {
            loadAdminIndex(function () {
                loadSection("/project/projects", "#MainContainer");
            });
        });
        $("#messages").click(function () {
            loadAdminIndex(function () {
                loadSection("/cordinator/Notifications", "#MainContainer");
            });
        });
        $("#Message").click(function () {
            loadAdminIndex(function () {
                loadSection("/cordinator/Notifications", "#MainContainer");
            });
        });
        $("#cordgroups").click(function () {
            loadAdminIndex(function () {
                loadSection("/cordinator/Studentgroup", "#MainContainer");
            });
        });
        $("#cordProject").click(function () {
            loadAdminIndex(function () {
                loadSection("/cordinator/Projects", "#MainContainer");
            });
        });
        $("#Submissions").click(function () {
            loadAdminIndex(function () {
                loadSection("/Project/ProjectList", "#MainContainer");
            });
        });
        $("#WeeklyLogs").click(function () {
            loadAdminIndex(function () {

                loadSection("/Project/weeklylog", "#MainContainer");
            });
        });
        $("#Evaluators").click(function () {
            loadAdminIndex(function () {

                loadSection("/studentGroups/Evaluators", "#MainContainer");
            });
        });
        $("#Rooms").click(function () {
            loadAdminIndex(function () {

                loadSection("/studentGroups/Rooms", "#MainContainer");
            });
        });
        $("#RoomIncharges").click(function () {
            loadAdminIndex(function () {

                loadSection("/studentGroups/RoomIncharges", "#MainContainer");
            });
        });
        $("#evaluationExam").click(function () {
            loadAdminIndex(function () {

                loadSection("/studentGroups/GroupEvaluation", "#MainContainer");
            });
        });
        $("#EvaluationDates").click(function () {
            loadAdminIndex(function () {

                loadSection("/cordinator/Evaluation", "#MainContainer");
            });
        });
        $("#Externals").click(function () {
            loadAdminIndex(function () {

                loadSection("/cordinator/ExternalsAccount", "#MainContainer");
            });
        });
        $("#GroupsEvaluation").click(function () {
            loadAdminIndex(function () {

                loadSection("/studentGroups/GroupEvaluation", "#MainContainer");
            });
        });

        // Call loadLastSection to load the last opened section on page load
        loadLastSection();
    });
</script>
